Ext.BLANK_IMAGE_URL="images/s.gif";var Tn={Ext:{},emptyFn:function(){},Application:function(A){Ext.apply(this,A);this.addEvents({"ready":true,"beforeunload":true,"sessionexpire":true});Ext.onReady(this.initApp,this)},Panel:{},TreeCover:{},ListOfAvailableIcons:["adverb","conjunction","pronoun","noun","verb","preposition","adjective"],SearchField:null,DictionaryWindow:null,windowCounter:0,launchUsingTips:function(){jQuery("#"+Tn.Constants.USING_TIPS_LAUNCHER_ID).find(":button").trigger("click")}};Tn.Constants={DICTIONARY_WINDOW_ID:"DICTIONARY_WINDOW",VIETNAMESE_ENGLISH_PANEL_ID:"VIETNAMESE_ENGLISH_PANEL",ENGLISH_VIETNAMESE_PANEL_ID:"ENGLISH_VIETNAMESE_PANEL",ENGLISH_ENGLISH_PANEL_ID:"ENGLISH_ENGLISH_PANEL",MESSAGE_OF_THE_DAY_WINDOW_ID:"MESSAGE_OF_THE_DAY_WINDOW",MESSAGE_OF_THE_DAY_PANEL_ID:"MESSAGE_OF_THE_DAY_PANEL",ENGLISH_VIETNAMESE_TREE_COMPONENT_ID:"ENGLISH_VIETNAMESE_TREE_COMPONENT_ID",ENGLISH_ENGLISH_TREE_COMPONENT_ID:"ENGLISH_ENGLISH_TREE_COMPONENT_ID",VIETNAMESE_ENGLISH_TREE_COMPONENT_ID:"VIETNAMESE_ENGLISH_TREE_COMPONENT_ID",VIETNAMESE_ENGLISH_VIETNAMESE_TREE_COMPONENT_ID:"VIETNAMESE_ENGLISH_VIETNAMESE_TREE_COMPONENT_ID",IDIOMS_THESAURUS_PANEL_ID:"IDIOM_THERASUS_PANEL",IDIOMS_THESAURUS_PANEL_TITLE:"Idioms & Thesaurus",MESSAGE_WINDOW_TITLE:"Message from Thieu Ngu",MESSAGE_CONTENT:"MESSAGE_CONTENT",USING_TIPS_WINDOW_TITLE:"Using Tips",USING_TIPS_WINDOW_ID:"USING_TIPS_WINDOW",USING_TIPS_DIV_CONTENT:"USING_TIPS_DIV_CONTENT",USING_TIPS_LAUNCHER_ID:"USING_TIPS_LAUNCHER",USING_TIPS_WINDOW_ICON_CLASS:"tn-using-tips",IDIOMS_TAB_ID:"IDIOM_TAB",IDIOMS_THERAUSUS_TAB_ID:"IDIOMS_THERAUSUS_TAB_ID",IDIOMS_TREE_COMPONENT_ID:"IDIOMS_TREE_COMPONENT_ID",THESAURUS_SYNONYM_TREE_COMPONENT_ID:"THESAURUS_SYNONYM_TREE_COMPONENT_ID",THESAURUS_ANTONYM_TREE_COMPONENT_ID:"THESAURUS_ANTONYM_TREE_COMPONENT_ID",THESAURUS_SYNONYM_TAB_ID:"THESAURUS_SYNONYM_TAB",THESAURUS_ANTONYM_TAB_ID:"THESAURUS_ANTONYM_TAB",DICTIONARY_SEARCH_FIELD:"DICTIONARY_SEARCH_FIELD",SUGGESTION_RECENT_FINDS_PANEL_ID:"SUGGESTION_RECENT_FINDS_PANEL",DICTIONARY_WINDOW_TITLE:"<b>Dictionary</b>",GUEST_BOOK_WINDOW_ID:"GUEST_BOOK_WINDOW_ID",GUEST_BOOK_PANEL_ID:"GUEST_BOOK_PANEL_ID",SIGN_BOOK_PANEL_ID:"SIGN_BOOK_PANEL_ID",GUEST_BOOK_WINDOW_TITLE:"Guestbook",DICTIONARY_WINDOW_ICON_CLASS:"tn-icon-dict",MESSAGE_WINDOW_ICON_CLASS:"tn-icon-message",ENGLISH_ENGLISH_PANEL_TITLE:"English - English Dictionary",ENGLISH_VIETNAMESE_PANEL_TITLE:"English - Vietnamese Dictionary",IDIOMS_TAB_TITLE:"Idioms",THESAURUS_TAB_TITLE:"Thesaurus",SUGGESTIONS_TAB_TITLE:"Suggestions",RECENT_FINDS_TAB_TITLE:"Recent Finds",ERROR_SUGGESTION_PANEL_ID:"ERROR_SUGGESTION_PANEL_ID",ERROR_SUGGESTION_PANEL_CONTENT:"ERROR_SUGGESTION_PANEL_CONTENT"};Tn.Utils={isArray:function(A){if(A instanceof Array){return true}else{return false}},disableContextMenu:function(A){A.oncontextmenu=function(){return false}},enableContextMenu:function(A){A.oncontextmenu=null},convertArrayToString:function(array,header,color){var str="";for(var index=0;index<array.length;index++){eval("str += '<li type=circle><font color="+color+"><b>' + array["+index+"]."+header+"+ '</b></font></li><br/>';")}return str},isStringOrNumber:function(A){return typeof A==="string"||typeof A==="number"},supplant:function(B,A){return B.replace(/{([^{}]*)}/g,function(D,C){var E=A[C];return Util.isStringOrNumber(E)?E:D})},jQant:function(B,A){return jQuery(Util.supplant(B,A))},existsAndNotEmpty:function(A){return A&&A[0]&&A[0]!==""&&A[0]!==null},isBlank:function(A){if(typeof A=="undefined"||A===null||A===false||(typeof A=="string"&&jQuery.trim(A)==="")){return true}if(A instanceof Array){for(var C=0,B=A.length;C<B;C++){if(isNotBlank(A[C])){return false}}}return false},isNotBlank:function(A){return !Util.isBlank(A)},removePunctuation:function(B){for(var A=B.length-1;A>=0;A--){if(B.charAt(A)!="!"&&B.charAt(A)!="."&&B.charAt(A)!=","&&B.charAt(A)!=")"&&B.charAt(A)!="("&&B.charAt(A)!="?"&&B.charAt(A)!="]"&&B.charAt(A)!="["&&B.charAt(A)!=";"&&B.charAt(A)!=":"){break}}return B.substring(0,A+1)},resizeAsDesktopApp:function(){window.resizeTo(288,window.screen.height);var A=Ext.get("x-windows");A.setHeight(5)},searchWord:function(A){if(Tn.SearchField===null){jQuery("button[@class*='x-btn-text tn-icon-dict']").trigger("click")}Tn.SearchField.search(A)}};Tn.Utils.getTextUnderTheMouse=(function(){function B(E){return E.toString()[0]}function D(E){return E.toString().substr(-1,1)}function A(E){return/\s/.test(E)}function C(E){var H=E.startOffset,G=E.endOffset;while(H>=0&&!A(B(E))){E.setStart(E.startContainer,H);H--}while(!A(D(E))){try{E.setEnd(E.endContainer,G)}catch(F){break}G++}return E.toString()}return function(G){G=G||window.event;var E=null;if(jQuery.browser.msie){E=document.body.createTextRange();E.moveToPoint(G.clientX,G.clientY);E.expand("word");if(E.text!==""){return E.text}else{var H=document.selection;if(H.type=="Text"){var F=H.createRange();return F.text}else{return""}}}else{E=document.createRange();E.setStart(G.rangeParent,G.rangeOffset);E.setEnd(G.rangeParent,G.rangeOffset);return C(E)}}})();Tn.Ext.TreeNodeUI=function(A){Tn.Ext.TreeNodeUI.superclass.constructor.call(this,A)};Ext.extend(Tn.Ext.TreeNodeUI,Ext.tree.TreeNodeUI);Tn.Ext.TreeNodeUI.prototype.renderElements=function(C,H,G,I){this.indentMarkup=C.parentNode?C.parentNode.ui.getChildIndent():"";var D=typeof H.checked=="boolean";var A=H.href?H.href:Ext.isGecko?"":"#";var B=['<li class="x-tree-node"><div ext:tree-node-id="',C.id,'" id="',C.id,'" class="x-tree-node-el x-tree-node-leaf ',H.cls,'">','<span class="x-tree-node-indent">',this.indentMarkup,"</span>",'<img src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />','<img src="',H.icon||this.emptyIcon,'" class="x-tree-node-icon',(H.icon?" x-tree-node-inline-icon":""),(H.iconCls?" "+H.iconCls:""),'" unselectable="on" />',D?('<input class="x-tree-node-cb" type="checkbox" '+(H.checked?'checked="checked" />':"/>")):"",'<a hidefocus="on" class="x-tree-node-anchor" href="',A,'" tabIndex="1" ',H.hrefTarget?' target="'+H.hrefTarget+'"':"",'><span unselectable="on">',C.text,"</span></a></div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join("");if(I!==true&&C.nextSibling&&C.nextSibling.ui.getEl()){this.wrap=Ext.DomHelper.insertHtml("beforeBegin",C.nextSibling.ui.getEl(),B)}else{this.wrap=Ext.DomHelper.insertHtml("beforeEnd",G,B)}this.elNode=this.wrap.childNodes[0];this.ctNode=this.wrap.childNodes[1];var F=this.elNode.childNodes;this.indentNode=F[0];this.ecNode=F[1];this.iconNode=F[2];var E=3;if(D){this.checkbox=F[3];E++}this.anchor=F[E];this.textNode=F[E].firstChild};Tn.Ext.TreeNode=function(A){A.uiProvider=Tn.Ext.TreeNodeUI;Tn.Ext.TreeNode.superclass.constructor.call(this,A);if(typeof (A.windowContent)!="undefined"){jQuery("#meaning_window_content").append("<div id = 'hidden-"+A.id+"'>"+A.windowContent+"</div>");jQuery("#meaning_window_content").append("<div id = 'hidden-meaning-"+A.id+"'>"+A.text+"</div>")}};Ext.extend(Tn.Ext.TreeNode,Ext.tree.TreeNode);Tn.TreeCover.Tree=function(A){jQuery.extend(this,A.dataObject);this.componentId=A.componentId;this.rootData=A.rootData;this.isExistingWord=this.rootData.pronunciation!=="";this.searchTerm=A.searchTerm;if(typeof (A.rootText)!="undefined"){this.rootText=A.rootText}};Tn.TreeCover.Tree.prototype={emptyFunction:function(){},retrieveIconOfPartOfSpeech:function(B,C){for(var A=0;A<Tn.ListOfAvailableIcons.length;A++){if(B==Tn.ListOfAvailableIcons[A]){return"images/icons/word_types/"+B+C}}return"images/icons/word_types/other"+C},createRootTree:function(B){var C=this.buildRootNodeText(this.rootData.written_form,this.rootData.pronunciation,B);var A=new Tn.Ext.TreeNode({text:C,id:"root",allowDrag:false,allowDrop:false,qtip:this.buildQTipsForRootNode(this.rootData.written_form,this.rootData.pronunciation)});return A},buildRootNodeText:function(F,C,B){var A="expandAllLink_"+B;var G="collapseAllLink_"+B;var E="word_sound_"+B;var D="";var H="";if(C!==null){H=" /"+C+"/"}if(C!==""){speak_url="/speak?text="+F.replace(" ","+");return"<b><font size = '2'>"+F+"</font></b>"+H+"&nbsp;&nbsp; <a href='#' id ='"+E+'\' onclick=\'jQuery("#audio_element").load("'+speak_url+"\");'><img src = 'images/icons/sound_add.png' ext:qtip='Listen'></img></a>&nbsp;&nbsp;&nbsp;<img src = 'images/icons/grid-blue-split.gif'></img>&nbsp;&nbsp;<a href = '#' id = '"+A+"'><img src = 'images/icons/expand-all.gif' ext:qtip='Expand all'></a>&nbsp; &nbsp;<a href = '#' id = '"+G+"'><img src = 'images/icons/collapse-all.gif' ext:qtip='Collapse all'></a><div id='audio_element'></div>"}else{return"<b><font size = '2'>"+F+"</font></b>&nbsp;&nbsp;&nbsp;&nbsp; <img src = 'images/icons/sound_delete.png'></img>&nbsp;&nbsp;&nbsp;"}},buildQTipsForRootNode:function(B,A){if(A!==""){return"<b><font size = '2'>"+B+"</font></b><br/>Pronunciation: <font color = 'green'><b>/ "+A+"</b> / </font> "}else{return"<b><font size = '2'>"+B+"</font></b><br/> Word cannot be found"}},setCollapseAndExpandAll:function(G,B,C){var E="collapseAllLink_"+G;var A="expandAllLink_"+G;Ext.get(A).on("click",function(){B.expandAll()});var F=this.rootData.written_form==this.searchTerm;var D=F?B.getRootNode():B.getRootNode().childNodes[1];Ext.get(E).on("click",function(){D.collapseChildNodes(true);if(C===true){D.expandChildNodes(false)}})},processDataObject:this.emptyFunction,launchErrorSuggestionPanel:function(desktop){function getdisplayedHtml(errorWord,callBackFtn){var html="";jQuery.post("dict/error_suggestion?query="+errorWord,function(json){try{var dataObject=eval("("+json+")")}catch(e){alert("Server is busy at this time. Please try again later");return }if(dataObject.suggestion.length===0){html+="<div class = 'error-suggestion-header'>No suggestion for word <b>"+errorWord+"</b> is available at the moment</div>"}else{var suggestions=dataObject.suggestion;html+="<div class = 'error-suggestion-header'>"+errorWord+" - "+suggestions.length+" Suggestions</div><br/>";jQuery.each(suggestions,function(i,aSuggestion){var action="javascript:Tn.Utils.searchWord('"+aSuggestion.written_form+"')";html+='<div onclick = "'+action+"\" style = 'float: left; cursor: pointer;'><img src = 'images/icons/book_previous.png' ext:qtip='Search word <b>"+aSuggestion.written_form+"</b>'>";html+="</div><div class = 'error-suggestion-word' onclick = \""+action+"\" style = 'cursor: pointer;' ext:qtip='Search word <b>"+aSuggestion.written_form+"</b>'>";html+=aSuggestion.written_form+"</div>";if(aSuggestion.summary!="nil"){html+="<div class = 'error-suggestion-summary'>"+aSuggestion.summary+"</div>"}html+="<br/><br/>"})}callBackFtn(html)})}function displayWindow(desktop,errorWord){var aWindow=desktop.getWindow(Tn.Constants.ERROR_SUGGESTION_PANEL_ID);var contentPanel=new Ext.Panel({id:Tn.Constants.ERROR_SUGGESTION_PANEL_CONTENT,layout:"fit",width:300,defaults:{bodyStyle:"padding:6px"},items:new Ext.Panel({id:"Suggestion_Panel_Id",layout:"anchor",html:"<img src = 'javascripts/ext_2.0a/resources/images/default/grid/grid-loading.gif'></img> Searching...<br/><br/>"})});if(!aWindow){aWindow=desktop.createWindow({id:Tn.Constants.ERROR_SUGGESTION_PANEL_ID,title:errorWord,width:300,x:310,y:10,shadow:false,iconCls:"tn-error-suggestion",shim:false,animCollapse:false,border:false,constrainHeader:true,layout:"fit",items:contentPanel})}else{aWindow.remove(Tn.Constants.ERROR_SUGGESTION_PANEL_CONTENT,true);aWindow.setTitle(errorWord);jQuery("button[@class='x-btn-text error-suggestion']").html(errorWord);aWindow.add(contentPanel);aWindow.doLayout()}aWindow.show();getdisplayedHtml(errorWord,function(html){aWindow.remove(Tn.Constants.ERROR_SUGGESTION_PANEL_CONTENT,true);contentPanel=new Ext.Panel({id:Tn.Constants.ERROR_SUGGESTION_PANEL_CONTENT,layout:"fit",width:300,defaults:{bodyStyle:"padding:6px"},items:new Ext.Panel({id:"Suggestion_Panel_Id",layout:"anchor",html:html})});aWindow.add(contentPanel);aWindow.doLayout()})}displayWindow(desktop,this.rootData.written_form)},buildTree:function(I,B,H,F){var G=true;var E=null;if(this.rootData.written_form!=this.searchTerm){G=false;E=new Tn.Ext.TreeNode({id:"root"});var D=new Tn.Ext.TreeNode({text:this.searchTerm+" == "+this.rootData.written_form});E.appendChild(D)}var A=this.createRootTree(B);if(E!==null){E.appendChild(A)}else{E=A}if(this.isExistingWord){H(A)}else{A.appendChild(new Tn.Ext.TreeNode({text:"Word cannot be found"}))}var C=new Ext.tree.TreePanel({title:typeof (F)!="undefined"?F:"",id:this.componentId,header:false,lines:true,border:false,rootVisible:true,autoScroll:true,root:E,rootVisible:G,animate:false,lines:false,hlColor:"ABABAB"});return C},pointTo:function(E,H,G,F,B,D){var A=this.processDataObject(H,E.id);var C=(this.rootData.written_form==this.searchTerm)?A.getRootNode():A.getRootNode().childNodes[1];E.remove(this.componentId);E.add(A);E.render();if(C!==null&&typeof (C)!="undefined"){C.expand();if(G===true){C.expandChildNodes(false)}if(this.isExistingWord){this.setCollapseAndExpandAll(E.id,A,true)}}if(typeof (D)!="undefined"){this.listenToRightClick(H,C)}B(F)},listenToRightClick:function(J,B){var I=B.childNodes;for(var H=0;H<I.length;H++){var F=I[H];for(var G=0;G<F.childNodes.length;G++){var A=F.childNodes[G].id;var D=this.rootData.written_form;var E=310;var C=10;jQuery("#"+A).bind("mousedown",function(N){var M="";E+=20;C+=20;if(Ext.isIE){M=(N.button<2)?"LEFT":((N.button==4)?"MIDDLE":"RIGHT")}else{M=(N.which<2)?"LEFT":((N.which==2)?"MIDDLE":"RIGHT")}if(M=="RIGHT"&&!N.shiftKey){var L=J.getWindow("window_"+this.id);if(!L){var K=document.getElementById("hidden-meaning-"+this.id).innerHTML;L=J.createWindow({id:"window_"+this.id,title:D+" - "+K.substring(0,10)+"...",width:300,x:E,y:C,iconCls:"tn-word-extend-meaning",shim:false,animCollapse:false,border:false,constrainHeader:true,layout:"fit",tbar:new Ext.Toolbar([{text:"Search <b>"+D+"</b>",tooltip:"Search this word",iconCls:"tn-meaning-search-again",handler:function(){Tn.SearchField.search(D)}},"-",{text:"Copy",tooltip:"Copy meaning to Clip Board",iconCls:"tn-meaning-save",handler:function(){copyToClipBoard(K)}}]),items:new Ext.Panel({layout:"fit",defaults:{bodyStyle:"padding:6px"},items:new Ext.Panel({layout:"anchor",html:document.getElementById("hidden-"+this.id).innerHTML})})})}L.show();L.setActive(true);L.toFront();Tn.Utils.disableContextMenu(this);return false}})}}}};Tn.TreeCover.ThesaurusTree=function(A){Tn.TreeCover.ThesaurusTree.superclass.constructor.call(this,A)};Ext.extend(Tn.TreeCover.ThesaurusTree,Tn.TreeCover.Tree,{constructThesaurusTree:function(){var A=new Tn.Ext.TreeNode({text:this.rootText,allowDrag:false,allowDrop:false});jQuery.each(this[this.rootText],function(C,D){if(D.word_list.length>0){var B=Tn.Utils.convertArrayToString(D.word_list,"written_form","green");var E=new Tn.Ext.TreeNode({text:D.meaning,qtipCfg:{text:"<b>Antonym</b><br/><br/>"+D.meaning+"<br/><br/>"+B,autoDismiss:false,dismissDelay:20000}});jQuery.each(D.word_list,function(F,G){E.appendChild(new Tn.Ext.TreeNode({text:G.written_form,icon:"images/icons/word_types/tick.png"}))});A.appendChild(E)}});return A},processDataObject:function(C,B){if(this.isExistingWord){var A=this.constructThesaurusTree()}else{if(this.rootText=="antonym"){this.launchErrorSuggestionPanel(C)}}return this.buildTree(C,B,function(D){if(A.childNodes.length>0){D.appendChild(A)}})}});Tn.TreeCover.IdiomsTree=function(A){Tn.TreeCover.IdiomsTree.superclass.constructor.call(this,A)};Ext.extend(Tn.TreeCover.IdiomsTree,Tn.TreeCover.Tree,{constructExplanationNodesOfIdiom:function(B){var A=[];jQuery.each(B.meanings,function(C,D){A[A.length]=new Tn.Ext.TreeNode({text:D.explanation,icon:"images/icons/word_types/tick.png"})});return A},buildIdiomsChildren:function(){var A=[];for(var B=0;B<this.idioms.length;B++){var D=this.idioms[B];var C=new Tn.Ext.TreeNode({text:D.written_form,qtip:this.constructQTipsForIdiom(D)});C.appendChild(this.constructExplanationNodesOfIdiom(D));A[A.length]=C}return A},constructQTipsForIdiom:function(A){quick_tips="<b>"+A.written_form+"</b></br>";quick_tips+="<br/>";if(A.meanings.length===0){quick_tips+="No meaning of this idiom is availabe at this moment";return quick_tips}jQuery.each(A.meanings,function(C,B){quick_tips+="<li><b><font color = 'green'>"+B.explanation+"</font></b>";if(B.examples.length>0){quick_tips+="<br/><br/>";quick_tips+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"}jQuery.each(B.examples,function(E,D){quick_tips+="<font color = 'blue'> - "+D.written_form+"</font><br/>";quick_tips+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";quick_tips+=""+D.explanation+"<br/>";quick_tips+="</li><br/>"})});quick_tips+="";return quick_tips},processDataObject:function(C,B){if(this.isExistingWord){var A=this.buildIdiomsChildren()}return this.buildTree(C,B,function(D){D.appendChild(A)})}});Tn.TreeCover.DictTree=function(A){Tn.TreeCover.DictTree.superclass.constructor.call(this,A)};Ext.extend(Tn.TreeCover.DictTree,Tn.TreeCover.Tree,{buildMeaningChildren:function(M){var B=0;var F="",C="";var D=0;var A=null;var N=[];var H=this.rootData.written_form;for(var J=0;J<this.meanings.length;J++){var E=this.meanings[J];C=E.part_of_speech_vn;if(F!=C){F=C;if(E.part_of_speech_vn===null){E.part_of_speech_vn="Others"}A=new Tn.Ext.TreeNode({text:this.componentId==Tn.Constants.ENGLISH_VIETNAMESE_TREE_COMPONENT_ID?E.part_of_speech_vn:E.part_of_speech_e,icon:this.retrieveIconOfPartOfSpeech(E.part_of_speech_e,"-root.gif")});B=1}var L="";if(E.examples.length===0){L="tn-meaning-leaf"}var I="<div class = 'meaning-header'>"+E.explanation+"</div><br/>";var G=E.examples;jQuery.each(G,function(P,O){I+="<div class = 'meaning-explanation'>"+O.written_form+"</div>";if(O.explanation!="nil"){I+="<div class = 'meaning-example'>"+O.explanation+"</div>"}I+="<br/><br/>"});var K=new Tn.Ext.TreeNode({id:"tree-node-id"+Tn.windowCounter++,text:E.explanation,singleClickExpand:true,iconCls:L,data:E,qtip:this.constructQTipsForWordMeaning(E),windowContent:I});K.appendChild(this.constructExampleNodesOfMeaning(E.examples,E.part_of_speech_e));A.appendChild(K);if(B==1){B=0;N[N.length]=A}}return N},constructExampleNodesOfMeaning:function(C,E){var B=[];for(var D=0;D<C.length;D++){var A=C[D];B[B.length]=new Tn.Ext.TreeNode({text:A.written_form,icon:this.retrieveIconOfPartOfSpeech(E,"-leaf.png")})}return B},constructQTipsForWordMeaning:function(B){var A="<b>"+B.explanation+"</b></br><br/>";if(B.examples.length===0){A+="No example of this meaning is available at this moment";return A}jQuery.each(B.examples,function(D,C){A+="<li><font color = 'blue'>"+C.written_form+"</font><br/>";if(C.explanation!="nil"){A+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";A+=""+C.explanation+"";A+="</li>"}A+="<br/>"});A+="";return A},processDataObject:function(D,B,C){var A=null;if(this.isExistingWord){A=this.buildMeaningChildren(D)}return this.buildTree(D,B,function(E){E.appendChild(A)},C)},pointToTabPanel:function(E,D,A,C){var B=(this.rootData.written_form==this.searchTerm)?C.getRootNode():C.getRootNode().childNodes[1];if(B!==null&&typeof (B)!="undefined"){B.expand();B.expandChildNodes(false);this.setCollapseAndExpandAll(Tn.Constants.ENGLISH_VIETNAMESE_TREE_COMPONENT_ID,C,true)}this.listenToRightClick(E,B);A(D)}});Tn.Panel.DictPanel=function(panelConfig,desktop){this.calledUrl=panelConfig.url;this.target=panelConfig.target;this.render=function(parameter,searchTerm){var arrayOfPanel=[];if(Tn.Utils.isArray(panelConfig.target)){for(var index=0;index<panelConfig.target.length;index++){var targetPanel=Ext.getCmp(panelConfig.target[index].id);targetPanel.body.mask("Searching...","x-mask-loading");arrayOfPanel[arrayOfPanel.length]=targetPanel}}jQuery.post(this.calledUrl,{"query":searchTerm},function(jsonString){try{var dataObject=eval("("+jsonString+")")}catch(e){alert("Server is busy at this time. Please try again later");return }if(jQuery("#meaning_window_content").length===0){var divContent=document.createElement("div");divContent.id="meaning_window_content";divContent.style.display="none";document.body.appendChild(divContent)}jQuery("#meaning_window_content").html("");if(Tn.Utils.isArray(panelConfig.target)){var rootData={"written_form":dataObject.ev_dict.written_form,"pronunciation":dataObject.ev_dict.pronunciation};if(typeof (dataObject.ve_dict.meanings)=="undefined"||dataObject.ve_dict.meanings.length===0){panelConfig.target[0].remove(Tn.Constants.ENGLISH_VIETNAMESE_TREE_COMPONENT_ID);panelConfig.target[0].remove(Tn.Constants.VIETNAMESE_ENGLISH_TREE_COMPONENT_ID);jQuery(jQuery("#ENGLISH_VIETNAMESE_PANEL").find("div")[0]).css("display","");jQuery(jQuery("#ENGLISH_VIETNAMESE_PANEL").find("span")[0]).html("English - Vietnamese Dictionary");var englishVietnameseRenderedTree=new Tn.TreeCover.DictTree({dataObject:dataObject.ev_dict,componentId:Tn.Constants.ENGLISH_VIETNAMESE_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm});var englishEnglishRenderedTree=new Tn.TreeCover.DictTree({dataObject:dataObject.ee_dict,componentId:Tn.Constants.ENGLISH_ENGLISH_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm});var idiomsRenderedTree=new Tn.TreeCover.IdiomsTree({dataObject:dataObject.idioms,componentId:Tn.Constants.IDIOMS_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm});var thesaurusSynonymRenderedTree=new Tn.TreeCover.ThesaurusTree({dataObject:dataObject.thesaurus,componentId:Tn.Constants.THESAURUS_SYNONYM_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm,rootText:"synonym"});var thesaurusAntonymRenderedTree=new Tn.TreeCover.ThesaurusTree({dataObject:dataObject.thesaurus,componentId:Tn.Constants.THESAURUS_ANTONYM_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm,rootText:"antonym"});englishVietnameseRenderedTree.pointTo(panelConfig.target[0],desktop,true,arrayOfPanel[0],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)},true);englishEnglishRenderedTree.pointTo(panelConfig.target[1],desktop,true,arrayOfPanel[1],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)},true);idiomsRenderedTree.pointTo(panelConfig.target[2],desktop,false,arrayOfPanel[2],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)});thesaurusSynonymRenderedTree.pointTo(panelConfig.target[3],desktop,true,arrayOfPanel[3],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)});thesaurusAntonymRenderedTree.pointTo(panelConfig.target[4],desktop,true,arrayOfPanel[4],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)})}else{rootData.pronunciation=dataObject.ve_dict.pronunciation;var vietnameseEnglishRenderedTreeLeft=new Tn.TreeCover.DictTree({dataObject:dataObject.ve_dict,componentId:Tn.Constants.VIETNAMESE_ENGLISH_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm});jQuery(jQuery("#ENGLISH_VIETNAMESE_PANEL").find("span")[0]).html("Vietnamese - English Dictionary");panelConfig.target[0].remove(Tn.Constants.VIETNAMESE_ENGLISH_TREE_COMPONENT_ID);panelConfig.target[0].remove(Tn.Constants.ENGLISH_VIETNAMESE_TREE_COMPONENT_ID);if(typeof (dataObject.ev_dict.meanings)!="undefined"&&dataObject.ev_dict.meanings.length>0){rootData.pronunciation=dataObject.ev_dict.pronunciation;var englishVietnameseRenderedTreeBelow=new Tn.TreeCover.DictTree({dataObject:dataObject.ev_dict,componentId:Tn.Constants.ENGLISH_VIETNAMESE_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm});var veTreeLeft=vietnameseEnglishRenderedTreeLeft.processDataObject(desktop,Tn.Constants.VIETNAMESE_ENGLISH_TREE_COMPONENT_ID,"Vietnamese - English");var evTreeBelow=englishVietnameseRenderedTreeBelow.processDataObject(desktop,Tn.Constants.ENGLISH_VIETNAMESE_TREE_COMPONENT_ID,"English - Vietnamese");jQuery(jQuery("#ENGLISH_VIETNAMESE_PANEL").find("div")[0]).css("display","none");var tabPanel=new Ext.TabPanel({border:false,split:true,id:Tn.Constants.ENGLISH_VIETNAMESE_TREE_COMPONENT_ID,activeTab:1,tabPosition:"top",resizeTabs:true,tabWidth:140,items:[evTreeBelow,veTreeLeft]});panelConfig.target[0].add(tabPanel);panelConfig.target[0].render();tabPanel.setActiveTab(tabPanel.getComponent(Tn.Constants.ENGLISH_VIETNAMESE_TREE_COMPONENT_ID));jQuery("#"+Tn.Constants.ENGLISH_VIETNAMESE_TREE_COMPONENT_ID).css("width",Ext.lib.Dom.getViewWidth()+"px");englishVietnameseRenderedTreeBelow.pointToTabPanel(desktop,panelConfig.target[0],function(){},veTreeLeft);vietnameseEnglishRenderedTreeLeft.pointToTabPanel(desktop,panelConfig.target[0],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)},evTreeBelow)}else{jQuery(jQuery("#ENGLISH_VIETNAMESE_PANEL").find("div")[0]).css("display","");vietnameseEnglishRenderedTreeLeft.pointTo(panelConfig.target[0],desktop,true,arrayOfPanel[0],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)},true)}if(typeof (dataObject.ee_dict.meanings)!="undefined"&&dataObject.ee_dict.meanings.length>0){rootData.pronunciation=dataObject.ee_dict.pronunciation;var englishEnglishRenderedTreeRight=new Tn.TreeCover.DictTree({dataObject:dataObject.ee_dict,componentId:Tn.Constants.ENGLISH_ENGLISH_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm});var idiomsRenderedTreeBottom=new Tn.TreeCover.IdiomsTree({dataObject:dataObject.idioms,componentId:Tn.Constants.IDIOMS_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm});var thesaurusSynonymRenderedTreeBottom=new Tn.TreeCover.ThesaurusTree({dataObject:dataObject.thesaurus,componentId:Tn.Constants.THESAURUS_SYNONYM_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm,rootText:"synonym"});var thesaurusAntonymRenderedTreeBottom=new Tn.TreeCover.ThesaurusTree({dataObject:dataObject.thesaurus,componentId:Tn.Constants.THESAURUS_ANTONYM_TREE_COMPONENT_ID,rootData:rootData,searchTerm:searchTerm,rootText:"antonym"});englishEnglishRenderedTreeRight.pointTo(panelConfig.target[1],desktop,true,arrayOfPanel[1],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)},true);idiomsRenderedTreeBottom.pointTo(panelConfig.target[2],desktop,false,arrayOfPanel[2],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)});thesaurusSynonymRenderedTreeBottom.pointTo(panelConfig.target[3],desktop,true,arrayOfPanel[3],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)});thesaurusAntonymRenderedTreeBottom.pointTo(panelConfig.target[4],desktop,true,arrayOfPanel[4],function(thisPanelComp){setTimeout(function(){thisPanelComp.body.unmask()},200)})}else{jQuery("#"+Tn.Constants.ENGLISH_ENGLISH_TREE_COMPONENT_ID).html("");jQuery("#THESAURUS_TREE_COMPONENT_ID").html("");jQuery("#IDIOMS_TREE_COMPONENT_ID").html("");arrayOfPanel[1].body.unmask();arrayOfPanel[2].body.unmask();arrayOfPanel[3].body.unmask();arrayOfPanel[4].body.unmask()}}}else{var renderedTree=new Tn.TreeCover.DictTree(dataObject);renderedTree.pointTo(panelConfig.target,desktop)}})}};Tn.Application.SearchField=Ext.extend(Ext.form.ComboBox,{initComponent:function(){if(!this.store.baseParams){this.store.baseParams={}}Tn.Application.SearchField.superclass.initComponent.call(this);this.on("specialkey",function(A,B){if(B.getKey()==B.ENTER){this.onTrigger2Click()}},this);this.triggerConfig={tag:"span",cls:"x-form-twin-triggers",cn:[{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger1Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.trigger2Class},{tag:"img",src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger x-form-arrow-trigger"}]}},getTrigger:function(A){return this.triggers[A]},initTrigger:function(){var A=this.trigger.select(".x-form-trigger",true);this.wrap.setStyle("overflow","hidden");var B=this;A.each(function(D,F,C){D.hide=function(){var G=B.wrap.getWidth();this.dom.style.display="none";B.el.setWidth(G-B.trigger.getWidth())};D.show=function(){var G=B.wrap.getWidth();this.dom.style.display="";B.el.setWidth(G-B.trigger.getWidth())};var E="Trigger"+(C+1);if(this["hide"+E]){D.dom.style.display="none"}D.on("click",this["on"+E+"Click"],this,{preventDefault:true});D.addClassOnOver("x-form-trigger-over");D.addClassOnClick("x-form-trigger-click")},this);this.triggers=A.elements},initEvents:function(){Ext.form.ComboBox.superclass.initEvents.call(this);this.keyNav=new Ext.KeyNav(this.el,{"up":function(A){this.inKeyMode=true;this.selectPrev()},"down":function(A){if(!this.isExpanded()){this.onTriggerClick()}else{this.inKeyMode=true;this.selectNextEntry()}},"enter":function(A){this.searchBySuggestion()},"esc":function(A){this.collapse()},"tab":function(A){this.onViewClick(false);return true},scope:this,doRelay:function(C,B,A){if(A=="down"||this.scope.isExpanded()){return Ext.KeyNav.prototype.doRelay.apply(this,arguments)}return true}});this.queryDelay=Math.max(this.queryDelay||10,this.mode=="local"?10:1500);this.dqTask=new Ext.util.DelayedTask(this.initQuery,this);if(this.typeAhead){this.taTask=new Ext.util.DelayedTask(this.onTypeAhead,this)}if(this.editable!==false){this.el.on("keyup",this.onKeyUp,this)}if(this.forceSelection){this.on("blur",this.doForce,this)}},selectNext:function(){var A=this.store.getCount();if(A>0){if(this.selectedIndex==-1){this.select(-1)}else{if(this.selectedIndex<A-1){this.select(this.selectedIndex+1)}}}},selectNextEntry:function(){var A=this.store.getCount();if(A>0){if(this.selectedIndex==-1){this.select(0)}else{if(this.selectedIndex<A-1){this.select(this.selectedIndex+1)}}}},onTrigger1Click:function(){if(this.hasSearch){this.el.dom.value="";this.triggers[0].hide();this.hasSearch=false;this.focus()}},onKeyUp:function(A){if(A.keyCode==115){return }this.suppressSuggestion(A.keyCode==A.ENTER);if(A.keyCode!=A.UP&&A.keyCode!=A.DOWN&&A.keyCode!=A.ENTER&&A.keyCode!=A.ESC&&A.keyCode!=17&&this.currentMode!=this.suggestionsMode){this.switchModeTo(this.suggestionsMode)}if(this.getRawValue()===""&&this.currentMode==this.suggestionsMode){this.collapse()}if(this.editable!==false&&!A.isSpecialKey()){this.lastKey=A.getKey();this.dqTask.delay(this.queryDelay)}},suppressSuggestion:function(A){if(A===true){this.minChars=1000}else{this.minChars=1}},onTrigger2Click:function(){this.collapse();this.suppressSuggestion(true);var B=this.getRawValue();this.lastQuery=B;if(B.length<1){this.onTrigger1Click();return }this.hasSearch=true;this.triggers[0].show();this.focus();if(Tn.Utils.isArray(this.renderedTreeCfg)){for(var C=0;C<this.renderedTreeCfg.length;C++){var A=new Tn.Panel.DictPanel(this.renderedTreeCfg[C],this.desktop);A.render(this.paramName,B)}}else{var D=new Tn.Panel.DictPanel(this.renderedTreeCfg,this.desktop);D.render(this.paramName,B)}this.collapse()},onTrigger3Click:function(){this.switchModeTo("RecentWords")},search:function(A){this.setRawValue(A);this.onTrigger2Click()},searchBySuggestion:function(){var A=this.view.getSelectedIndexes()[0];var B=this.store.getAt(A);if(B){this.setRawValue(B.data.written_form)}if(jQuery.browser.msie){}else{this.onTrigger2Click()}this.collapse()},switchModeTo:function(A){this.currentMode=A;var B="";if(A==this.suggestionsMode){this.minChars=1;B="suggest"}if(A==this.recentWordsMode){this.minChars=0;B="dict/recent_look_ups"}this.store.proxy=new Ext.data.HttpProxy({url:B});this.switchOnViewMode(A);this.onTriggerClick()},switchOnViewMode:function(A){if(this.currentMode==this.suggestionsMode){this.onViewClick=function(B){this.onViewClickForSuggestionMode(B)}}else{this.onViewClick=function(B){this.onViewClickForRecentWordsMode(B)}}},onViewClickForRecentWordsMode:function(B){var A=this.view.getSelectedIndexes()[0];var C=this.store.getAt(A);if(C){this.setRawValue(C.data.written_form)}this.collapse();if(B!==false){this.el.focus()}this.onTrigger2Click()},onViewClickForSuggestionMode:function(B){var A=this.view.getSelectedIndexes()[0];var C=this.store.getAt(A);if(C){this.onSelect(C,A)}if(B!==false){this.el.focus()}},onTriggerClick:function(){if(this.disabled){return }if(this.isExpanded()){this.collapse();this.el.focus()}else{this.onFocus({});if(this.triggerAction=="all"){this.doQuery(this.allQuery,true)}else{if(this.currentMode==this.suggestionsMode){this.doQuery(this.getRawValue())}else{this.doQuery("")}}this.el.focus()}},validationEvent:false,validateOnBlur:false,trigger1Class:"x-form-clear-trigger",trigger2Class:"x-form-search-trigger",hideTrigger1:true,width:180,hasSearch:false,paramName:"query",suggestionsMode:"Suggestions",recentWordsMode:"RecentWords",currentMode:"Suggestions"});Tn.Layout=function(){var L=Ext.get("x-desktop");var D=Ext.get("x-taskbar");var F=Ext.get("x-windows");var I=new Ext.WindowGroup();var B;function C(M){M.minimized=true;M.hide()}function J(M){if(B&&B!=M){K(B)}B=M;Ext.fly(M.taskItem.el).addClass("active-win");M.minimized=false;if(M.id==Tn.Constants.DICTIONARY_WINDOW_ID){setTimeout(function(){jQuery("#DICTIONARY_SEARCH_FIELD").focus()},200)}}function K(M){if(M==B){B=null;Ext.fly(M.taskItem.el).removeClass("active-win")}}function H(){var N=new Ext.menu.Menu({items:[{text:"Auto Hide",handler:function(){F.setHeight(5);E();jQuery("#x-windows").mouseover(function(){F.setHeight(29);E()});jQuery("#x-windows").mouseout(function(){F.setHeight(5);E();return false})},scope:this},{text:"Always Show",handler:function(){jQuery("#x-windows").unbind("mouseover");jQuery("#x-windows").unbind("mouseout");F.setHeight(29);E()},scope:this}]});var M=document.getElementById("x-windows");M.oncontextmenu=function(P){if(!N.el){N.render()}var O=[xMousePos,yMousePos];O[1]-=N.el.getHeight();N.showAt(O);return false}}function A(M){M.taskItem.destroy();if(M.id==Tn.Constants.DICTIONARY_WINDOW_ID){Tn.SearchField=null}}function E(M){Tn.DesktopHeight=Ext.lib.Dom.getViewHeight()-(D?D.getHeight():0)-F.getHeight();L.setHeight(Tn.DesktopHeight);G();jQuery("#x-windows").find("button").toggle().toggle()}function G(){var N=Ext.lib.Dom.getViewWidth();var O=N-260;var M=Ext.lib.Dom.getViewHeight()+(D?D.getHeight():0)-390;jQuery("#thieungulogo").css({"left":O,"top":250});jQuery("#thieunguquote").css({"left":(N-250),"top":150});jQuery("#thieungu").css({"left":(N-350),"top":80});var P=I.get(Tn.Constants.DICTIONARY_WINDOW_ID);if(P){if(P.getSize().height===0){if(Ext.isIE){P.setHeight(Tn.DesktopHeight-72-P.getPosition()[1])}else{P.setHeight(Tn.DesktopHeight-65-P.getPosition()[1])}}else{if(Ext.isIE){P.setHeight(Tn.DesktopHeight+27-P.getPosition()[1])}else{P.setHeight(Tn.DesktopHeight+30-P.getPosition()[1])}}}}Ext.EventManager.onWindowResize(E);this.layout=E;this.createWindow=function(N,M){var O=new (M||Ext.Window)(Ext.applyIf(N||{},{manager:I,minimizable:true,maximizable:true}));O.render(L);O.taskItem=new Tn.Layout.TaskBarItem(O);O.cmenu=new Ext.menu.Menu({items:[]});O.on("activate",J);O.on("beforeshow",J);O.on("deactivate",K);O.on("minimize",C);O.on("close",A);Tn.DesktopHeight=Ext.lib.Dom.getViewHeight()-(D?D.getHeight():0)-F.getHeight();L.setHeight(Tn.DesktopHeight);return O};this.getManager=function(){return I};this.getWindow=function(M){return I.get(M)};E();H()};Tn.Layout.TaskBarItem=function(A){this.win=A;Tn.Layout.TaskBarItem.superclass.constructor.call(this,{iconCls:A.iconCls,text:A.title,renderTo:"x-winlist",handler:function(){if(A.minimized||A.hidden){A.show()}else{if(A==A.manager.getActive()){A.minimize()}else{A.toFront()}}},clickEvent:"mousedown"})};Ext.extend(Tn.Layout.TaskBarItem,Ext.Button,{onRender:function(){Tn.Layout.TaskBarItem.superclass.onRender.apply(this,arguments);this.cmenu=new Ext.menu.Menu({items:[{text:"Restore",handler:function(){if(!this.win.isVisible()){this.win.show()}else{this.win.restore()}},scope:this},{text:"Minimize",handler:this.win.minimize,scope:this.win},{text:"Maximize",handler:this.win.maximize,scope:this.win},"-",{text:"Close",handler:this.win.close,scope:this.win}]});this.cmenu.on("beforeshow",function(){var B=this.cmenu.items.items;var A=this.win;B[0].setDisabled(A.maximized!==true&&A.hidden!==true);B[1].setDisabled(A.minimized===true);B[2].setDisabled(A.maximized===true||A.hidden===true)},this);this.el.on("contextmenu",function(B){B.stopEvent();if(!this.cmenu.el){this.cmenu.render()}var A=B.getXY();A[1]-=this.cmenu.el.getHeight();this.cmenu.showAt(A)},this)}});Ext.extend(Tn.Application,Ext.util.Observable,{isReady:false,initApp:function(){this.layout=new Tn.Layout();this.launcher=new Ext.Toolbar({renderTo:"x-launcher"});var C=this.getModules();if(C){this.initModules(C)}this.init();Ext.EventManager.on(window,"beforeunload",this.onUnload,this);this.fireEvent("ready",this);this.isReady=true;C[3].createWindow();C[0].createWindow();if(Ext.isMac&&Ext.isGecko){jQuery(document).bind("keydown",function(E){if(E.keyCode==9){setTimeout(function(){jQuery("#DICTIONARY_SEARCH_FIELD").focus().val("")},100);E.stopPropagation();return false}})}else{jQuery(document).bind("keydown",function(E){if(E.keyCode==9){jQuery("#DICTIONARY_SEARCH_FIELD").focus().val("");E.stopPropagation();return false}})}jQuery("#thieungulogo").html("<img src = 'images/logos/tnlogo.png' id = 'tnmainlogo'></img><a href = '#' id = 'resize-link' style = 'display:none;'>Resize</a>");jQuery("#thieunguquote").addClass("tn-thieungu-bubble");jQuery("#thieunguquote").html("<div class = 'text-in-bubble'><img src = 'images/icons/lightbulb.png'></img><u>Tips:</u> You can press <b>F4</b> to maximize / restore the dictionary<br/><div align = 'center'><a href = '#' onclick = 'javascript:Tn.launchUsingTips();'>Learn More...</a></div></div>");var B=false;jQuery("#resize-link").click(function(){if(!B){C[0].setPosition(0,0);C[0].resizeWindow(310,Tn.DesktopHeight);window.resizeTo(296,window.screen.height);C[0].maximizeWindow();B=true;jQuery("#x-windows").css("display","none");jQuery("#x-taskbar").css("display","none");jQuery("div[@class*=x-tool-maximize]").css("display","none");jQuery("div[@class*=x-tool-minimize]").css("display","none");jQuery("div[@class*=x-tool-restore]").css("display","none");jQuery("div[@class*=x-tool-close]").css("display","none");jQuery("button[@class*='pop-out-icon']").css("display","none");jQuery("#DICTIONARY_WINDOW").find("div[@class*=tn-icon-dict]").prepend("<div class='x-tool pop-in-icon' ext:qtip='Pop in' id = 'pop-in-div'></div>");jQuery("span[@class*=ytb-sep]").css("display","none");jQuery("#DICTIONARY_SEARCH_FIELD").parent().css("width","310px");jQuery("#DICTIONARY_SEARCH_FIELD").css("width","257px");jQuery("div[@class*=pop-in-icon]").click(function(){jQuery("#resize-link").trigger("click")});for(var E=1;E<C.length;E++){C[E].destroyWindow()}B=true}else{parent.window.resizeTo(window.screen.width,window.screen.height);Ext.get("x-windows").setHeight(29);C[0].restoreWindow();jQuery("#DICTIONARY_SEARCH_FIELD").css("width","227px");jQuery("#DICTIONARY_SEARCH_FIELD").parent().css("width","261px");jQuery("span[@class*=ytb-sep]").css("display","");jQuery("button[@class*=pop-out-icon]").css("display","");B=false;jQuery("#x-taskbar").css("display","");jQuery("#x-windows").css("display","");jQuery("div").remove("#pop-in-div");jQuery("button[@class*='pop-in-icon']").css("display","");jQuery("div[@class*=x-tool-close]").css("display","");jQuery("div[@class*=x-tool-maximize]").css("display","");jQuery("div[@class*=x-tool-minimize]").css("display","")}});this.putThieunguSlogan();this.fixPng();jQuery("#THIEUNGU_MSG_LAUNCHER").css("display","none");jQuery("#"+Tn.Constants.DICTIONARY_SEARCH_FIELD).bind("keydown",function(E){if(E.keyCode==17){Tn.SearchField.switchModeTo("RecentWords")}});var D=Ext.get("loading");var A=Ext.get("loading-mask");A.setOpacity(0.8);A.shift({xy:D.getXY(),width:D.getWidth(),height:D.getHeight(),remove:true,duration:1,opacity:0.3,easing:"bounceOut",callback:function(){D.fadeOut({duration:0.5,remove:true});jQuery("#DICTIONARY_SEARCH_FIELD").focus()}})},fixPng:function(){if(Ext.isIE6){jQuery("#tnmainlogo").ifixpng();jQuery("#thieunguquote").ifixpng()}},putThieunguSlogan:function(){jQuery("#thieungu").html("<a href='http://www.thieungu.com' target='_blank'><img src = 'images/logos/thieungu.png' id = 'thieungumainlogo'></img></a>&nbsp;&nbsp;<br/><br/>");jQuery("#thieungumainlogo").ifixpng()},getModules:Ext.emptyFn,init:Ext.emptyFn,initModules:function(B){for(var D=0,A=B.length;D<A;D++){var C=B[D];this.launcher.add(C.launcher);C.app=this}},onReady:function(B,A){if(!this.isReady){this.on("ready",B,A)}else{B.call(A,this)}},getLayout:function(){return this.layout},onUnload:function(A){if(this.fireEvent("beforeunload",this)===false){A.stopEvent()}}});Ext.app.Module=function(A){Ext.apply(this,A);Ext.app.Module.superclass.constructor.call(this);this.init()};Ext.extend(Ext.app.Module,Ext.util.Observable,{init:function(){}});Tn.Application.DictionaryWindow=Ext.extend(Ext.app.Module,{init:function(){this.launcher={text:Tn.Constants.DICTIONARY_WINDOW_TITLE,iconCls:Tn.Constants.DICTIONARY_WINDOW_ICON_CLASS,handler:this.createWindow,scope:this}},resizeWindow:function(B,A){var D=this.app.getLayout();var C=D.getWindow(Tn.Constants.DICTIONARY_WINDOW_ID);if(!C){return }C.setSize({width:B,height:A})},maximizeWindow:function(){var B=this.app.getLayout();var A=B.getWindow(Tn.Constants.DICTIONARY_WINDOW_ID);if(!A){return }A.maximize()},restoreWindow:function(){var B=this.app.getLayout();var A=B.getWindow(Tn.Constants.DICTIONARY_WINDOW_ID);if(!A){return }A.restore()},setPosition:function(C,B){var D=this.app.getLayout();var A=D.getWindow(Tn.Constants.DICTIONARY_WINDOW_ID);if(!A){return }A.setPosition(C,B)},createWindow:function(){var L=this.app.getLayout();var H=L.getWindow(Tn.Constants.DICTIONARY_WINDOW_ID);var G=new Ext.Panel({header:true,layout:"fit",region:"center",id:Tn.Constants.ENGLISH_VIETNAMESE_PANEL_ID,margins:"0 0 0 2",title:Tn.Constants.ENGLISH_VIETNAMESE_PANEL_TITLE,defaults:{bodyStyle:"padding:3px"}});var F=new Ext.Panel({header:true,layout:"fit",region:"east",split:true,width:293,minWidth:293,collapsible:true,collapsed:true,autoShow:true,margins:"0 2 0 0",cmargins:"0 2 0 2",id:Tn.Constants.ENGLISH_ENGLISH_PANEL_ID,title:Tn.Constants.ENGLISH_ENGLISH_PANEL_TITLE,defaults:{bodyStyle:"padding:3px"}});var D=new Ext.Panel({header:true,layout:"fit",id:Tn.Constants.IDIOMS_TAB_ID,title:Tn.Constants.IDIOMS_TAB_TITLE,defaults:{bodyStyle:"padding:3px"}});var I=new Ext.Panel({header:true,layout:"fit",id:Tn.Constants.THESAURUS_SYNONYM_TAB_ID,title:"Synonym",defaults:{bodyStyle:"padding:3px"}});var B=new Ext.Panel({header:true,layout:"fit",id:Tn.Constants.THESAURUS_ANTONYM_TAB_ID,title:"Antonym",defaults:{bodyStyle:"padding:3px"}});var K=new Ext.Panel({layout:"border",region:"south",split:true,height:175,minHeight:175,maxSize:400,collapsible:true,collapsed:true,margins:"0 2 0 2",cmargins:"2 2 2 2",id:Tn.Constants.IDIOMS_THESAURUS_PANEL_ID,title:Tn.Constants.IDIOMS_THESAURUS_PANEL_TITLE,items:[new Ext.TabPanel({border:false,split:true,id:Tn.Constants.IDIOMS_THERAUSUS_TAB_ID,activeTab:1,region:"center",tabPosition:"bottom",items:[D,I,B]})]});var A=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:"suggest"}),reader:new Ext.data.JsonReader({root:"suggestions",totalProperty:"totalCount",id:"suggestion_id"},[{name:"written_form"},{name:"summary"}])});var E=new Ext.XTemplate('<tpl for="."><div class="search-item">',"<h3><span></span>{written_form}</font></h3>","{summary}","</div></tpl>");Tn.SearchField=new Tn.Application.SearchField({id:Tn.Constants.DICTIONARY_SEARCH_FIELD,width:261,store:A,displayField:"written_form",typeAhead:false,loadingText:"Searching...",emptyText:"Enter a word...",hideTrigger:false,tpl:E,minChars:1,resizable:true,selectOnFocus:false,paramName:"query",itemSelector:"div.search-item",desktop:L,renderedTreeCfg:[{url:"dict",target:[G,F,D,I,B]}],onSelect:function(M){this.setValue(M.data.written_form);this.search(M.data.written_form);this.collapse()}});var C=new Ext.Panel({id:"DICTIONARY_MOTHER_LAYOUT",minWidth:340,layout:"border",border:false,items:[G,K,F]});if(!H){H=L.createWindow({id:Tn.Constants.DICTIONARY_WINDOW_ID,title:Tn.Constants.DICTIONARY_WINDOW_TITLE,width:310,minWidth:310,x:10,y:5,height:Ext.isIE?Tn.DesktopHeight-10:Tn.DesktopHeight-10,iconCls:Tn.Constants.DICTIONARY_WINDOW_ICON_CLASS,shim:false,animCollapse:false,constrainHeader:true,layout:"fit",tbar:new Ext.Toolbar([Tn.SearchField,"-",{tooltip:"Pop out as Desktop Application",iconCls:"pop-out-icon",handler:function(){jQuery("#resize-link").trigger("click")}}]),items:[C],onEsc:Tn.emptyFn})}H.show();jQuery(document).keydown(function(M){if(M.keyCode==115){if(H.maximized===true){H.restore()}else{if(H.minimized===false){H.maximize()}}return false}});jQuery("img[@class*=x-form-trigger]").css("height","25px");jQuery("img[@class=x-form-trigger x-form-arrow-trigger]").attr("ext:qtip","Recent Founds");jQuery("img[@class=x-form-trigger x-form-search-trigger]").attr("ext:qtip","Search");jQuery("img[@class=x-form-trigger x-form-clear-trigger]").attr("ext:qtip","Clear Search Box");var J=K.getComponent(Tn.Constants.IDIOMS_THERAUSUS_TAB_ID);J.setActiveTab(J.getComponent(Tn.Constants.THESAURUS_ANTONYM_TAB_ID));J.setActiveTab(J.getComponent(Tn.Constants.IDIOMS_TAB_ID));return H}});Tn.Application.Message=Ext.extend(Ext.app.Module,{init:function(){this.launcher={id:"THIEUNGU_MSG_LAUNCHER",text:Tn.Constants.MESSAGE_WINDOW_TITLE,iconCls:Tn.Constants.MESSAGE_WINDOW_ICON_CLASS,handler:this.createWindow,scope:this}},destroyWindow:function(){var B=this.app.getLayout();var A=B.getWindow(Tn.Constants.MESSAGE_OF_THE_DAY_WINDOW_ID);if(!A){return }A.close()},createWindow:function(){var E=this.app.getLayout();var D=E.getWindow(Tn.Constants.MESSAGE_OF_THE_DAY_WINDOW_ID);var B=new Ext.Panel({header:false,border:true,layout:"fit",region:"center",id:Tn.Constants.MESSAGE_OF_THE_DAY_PANEL_ID,title:"English",margins:"0 0 0 0",autoScroll:true,defaults:{bodyStyle:"padding:6px"},autoLoad:"html/beta-launch-message.html"});var A=new Ext.Panel({header:false,border:true,layout:"fit",region:"center",id:Tn.Constants.MESSAGE_OF_THE_DAY_PANEL_ID+"VN",margins:"0 0 0 0",autoScroll:true,title:"Vietnamese",defaults:{bodyStyle:"padding:6px"},autoLoad:"html/beta-launch-message-vn.html"});var C=new Ext.TabPanel({minWidth:340,activeTab:0,border:false,margins:"0 0 0 0",defaults:{bodyStyle:"padding:6px"},items:[A,B]});if(!D){D=E.createWindow({id:Tn.Constants.MESSAGE_OF_THE_DAY_WINDOW_ID,title:Tn.Constants.MESSAGE_WINDOW_TITLE,width:310,minHeight:310,height:310,minWidth:310,x:440,y:150,iconCls:Tn.Constants.MESSAGE_WINDOW_ICON_CLASS,shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:[C],onEsc:Tn.emptyFn})}D.show();return D}});Tn.Application.UsingTips=Ext.extend(Ext.app.Module,{init:function(){this.launcher={id:Tn.Constants.USING_TIPS_LAUNCHER_ID,text:Tn.Constants.USING_TIPS_WINDOW_TITLE,iconCls:Tn.Constants.USING_TIPS_WINDOW_ICON_CLASS,handler:this.createWindow,scope:this}},destroyWindow:function(){var B=this.app.getLayout();var A=B.getWindow(Tn.Constants.USING_TIPS_WINDOW_ID);if(!A){return }A.close()},createWindow:function(){var D=this.app.getLayout();var B=D.getWindow(Tn.Constants.USING_TIPS_WINDOW_ID);var C=new Ext.Panel({header:false,layout:"fit",region:"center",margins:"0 0 0 0",autoScroll:true,defaults:{bodyStyle:"padding:6px"},autoLoad:"html/using-tips.html"});var A=new Ext.Panel({minWidth:340,layout:"border",border:false,margins:"0 0 0 0",defaults:{bodyStyle:"padding:6px"},items:[C]});if(!B){B=D.createWindow({id:Tn.Constants.USING_TIPS_WINDOW_ID,title:Tn.Constants.USING_TIPS_WINDOW_TITLE,width:310,minHeight:300,height:380,minWidth:310,x:600,y:140,iconCls:Tn.Constants.USING_TIPS_WINDOW_ICON_CLASS,shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:[A],onEsc:Tn.emptyFn})}B.show();return B}});Tn.Application.Notepad=Ext.extend(Ext.app.Module,{init:function(){this.launcher={text:"<b>Notepad</b>",iconCls:"tn-thieungu-notepad",handler:this.createWindow,scope:this}},destroyWindow:function(){var B=this.app.getLayout();var A=B.getWindow("THIEUNGU_NOTE_PAD");if(!A){return }A.close()},createWindow:function(){var B=this.app.getLayout();var A=B.getWindow("THIEUNGU_NOTE_PAD");if(!A){A=B.createWindow({id:"THIEUNGU_NOTE_PAD",title:"<b>Thieu Ngu Notepad</b>",width:310,minHeight:310,height:310,minWidth:310,x:340,y:180,iconCls:"tn-thieungu-notepad",shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:[new Ext.form.TextArea({id:"notepad",height:100,width:100,emptyText:"Thieu Ngu Notepad 1.0.0"})],onEsc:Tn.emptyFn})}A.show();jQuery("#notepad").focus();return A}});Tn.Application.Guestbook=Ext.extend(Ext.app.Module,{init:function(){this.launcher={text:Tn.Constants.GUEST_BOOK_WINDOW_TITLE,iconCls:Tn.Constants.MESSAGE_WINDOW_ICON_CLASS,handler:this.createWindow,scope:this}},createWindow:function(){var F=this.app.getLayout();var E=F.getWindow(Tn.Constants.GUEST_BOOK_WINDOW_ID);var B=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:"guestbook/get_data"}),reader:new Ext.data.JsonReader({root:"entries",totalProperty:"totalCount",id:"entryid",fields:["visitor","subject","content","recordTime"]}),remoteSort:false});B.setDefaultSort("recordTime","desc");var A=new Ext.grid.ColumnModel([{id:"post",header:"Post",dataIndex:"subject",width:250,renderer:function(I,H,G){return String.format('<b><div class = "x-grid3-td-topic">{0}</div></b>',I)}},{id:"visitor",header:"Poster",dataIndex:"visitor",width:80,renderer:function(I,H,G){return String.format('<div class = "x-grid3-td-visitor">{0}</div>',I)}},{id:"date",header:"Created Date",dataIndex:"recordTime",width:180,renderer:function(I,H,G){return String.format("{0}",I)}}]);A.defaultSortable=true;var D=new Ext.grid.GridPanel({width:500,height:500,header:false,store:B,cm:A,trackMouseOver:true,sm:new Ext.grid.RowSelectionModel({selectRow:Ext.emptyFn}),loadMask:true,viewConfig:{forceFit:true,enableRowBody:true,getRowClass:function(G,J,I,H){I.body="<p>"+G.data.content+"</p>";return"x-grid3-row-expanded"}},bbar:new Ext.PagingToolbar({pageSize:25,store:B,displayInfo:true,displayMsg:"Displaying posts {0} - {1} of {2}",emptyMsg:"No topics to display",items:["-",{pressed:true,text:"Sign Guestbook",cls:"x-btn-text-icon sign-guestbook",handler:function(){var H=new Ext.form.FormPanel({baseCls:"x-plain",labelWidth:55,url:"guestbook/save_guest_book_sign",defaultType:"textfield",items:[{id:"guest_book_nick_name",fieldLabel:"Nickname",name:"nickname",anchor:"100%"},{id:"guest_book_subject",fieldLabel:"Subject",name:"subject",anchor:"100%"},{id:"guest_book_content",fieldLabel:"Content",xtype:"textarea",hideLabel:true,name:"Content",anchor:"100% -53"}]});var G=new Ext.Window({id:"SIGN_GUESTBOOK_WINDOW",title:"Sign Thieu Ngu Guest Book",width:500,height:230,minWidth:300,minHeight:200,layout:"fit",plain:true,bodyStyle:"padding:5px;",buttonAlign:"center",items:H,buttons:[{text:"Sign",handler:function(){var K=jQuery("#guest_book_nick_name").val();var J=jQuery("#guest_book_content").val();var I=jQuery("#guest_book_subject").val();jQuery("#sign-guestbook-cancel").trigger("click");jQuery.post("guestbook/save_guest_book_sign",{nickname:K,subject:I,content:J},function(){B.load({params:{start:0,limit:25},callback:function(){jQuery("div[@class=x-grid3-body]").find("table[@class=x-grid3-row-table]").eq(0).hide().fadeIn(2000)}});setTimeout(function(){},1000)})}},{text:"Cancel",id:"sign-guestbook-cancel"}]});G.show();jQuery("#sign-guestbook-cancel").click(function(){G.close()})}}]})});if(!E){E=F.createWindow({id:Tn.Constants.GUEST_BOOK_WINDOW_ID,title:Tn.Constants.GUEST_BOOK_WINDOW_TITLE,width:520,minHeight:310,height:340,minWidth:520,maxWidth:310,x:460,y:170,iconCls:Tn.Constants.MESSAGE_WINDOW_ICON_CLASS,shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:D,onEsc:Tn.emptyFn})}E.show();B.load({params:{start:0,limit:25}});function C(H,I){var G=D.getView();G.showPreview=I;G.refresh()}jQuery("#sign-guestbook-link").bind("click",function(){return false});return E},destroyWindow:function(){var B=this.app.getLayout();var A=B.getWindow(Tn.Constants.GUEST_BOOK_WINDOW_ID);if(!A){return }A.close()}});TnApplication=new Tn.Application({init:function(){Ext.QuickTips.init()},getModules:function(){return[new Tn.Application.DictionaryWindow(),new Tn.Application.Notepad(),new Tn.Application.UsingTips(),new Tn.Application.Message(),new Tn.Application.Guestbook()]}});jQuery(document).ready(function(){jQuery(document).bind("mouseup",function(event){if(event.button==2&&!event.shiftKey){Tn.Utils.enableContextMenu(document)}});function createBuble(text){jQuery("div").remove("#bubble");var xBubblePos=xMousePos-88;var yBubblePos=yMousePos-118;text=jQuery.trim(text);text=Tn.Utils.removePunctuation(text);if(text===""){return }else{jQuery(document.body).append("<div style = 'position: absolute; left: "+xBubblePos+"; top: "+yBubblePos+"; width: 220px; height: 120px; opacity: 1; background:url(images/logos/bubble.png) no-repeat; cursor: move;' id = 'bubble'><div align = 'center' style = 'position: relative; width:220px; top: 12px;'><b>"+text+"</b></div><div style = 'position: relative; left: 155px; top: 2px; cursor: pointer;'><a href = '#' onclick = 'javascript:jQuery(\"div\").remove(\"#bubble\");'><img src = 'images/icons/cross.png' border = '0' width='10px' ext:qtip='Close me'></img></a></div><div id = 'bubble-text' style = 'position: relative; left: 14px; top: 10px;width:190px;'><img src = 'javascripts/ext_2.0a/resources/images/default/grid/grid-loading.gif'> Searching ...</div></div>");jQuery("#bubble").ifixpng();jQuery.post("dict/find_summary?query="+text,function(json){var data=eval("("+json+")");var summary="This word cannot be found!";if(data.summary!==""){summary=data.summary.substring(0,56)+"...<br/><div align = 'center'><a href = \"javascript:Tn.Utils.searchWord('"+text+"')\">Search...</a></div>"}jQuery("#bubble-text").html(summary)})}var resizer=new Ext.Resizable("bubble",{handles:"all",draggable:true,transparent:true,enabled:false,minWidth:200,minHeight:100,maxWidth:500,maxHeight:400,pinned:true});jQuery("#bubble").dblclick(function(){jQuery("div").remove("#bubble")});return false}function createBubbleTextForRightClick(event){if(event.shiftKey&&event.button==2){var text=Tn.Utils.getTextUnderTheMouse(event);createBuble(text);Tn.Utils.disableContextMenu(document);return false}}function createBubbleTextForDblClick(event){var text=Tn.Utils.getTextUnderTheMouse(event);createBuble(text);return false}jQuery(document).bind("mousedown",createBubbleTextForRightClick)})